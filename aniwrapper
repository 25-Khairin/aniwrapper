#!/usr/bin/env bash

[ -z "$XDG_CONFIG_HOME" ] && XDG_CONFIG_HOME="$HOME/.config"

CMD=/usr/local/bin/ani-cli
DEFAULT="$HOME/Videos/sauce/"
CFG_DIR="$XDG_CONFIG_HOME/ani-cli"
CFG_FILE="meh.rasi"

# echo "CONFIG DIR: $CFG_DIR"

# not a wrapper around the ani-cli-rofi

options="1. Stream|2. Download|3. Continue|4. Quit"

choice=$(echo "${options[@]}" | rofi -dmenu -sep '|' -config "$CFG_DIR/$CFG_FILE" -l 4 -i -p "Enter choice:")

[ "$choice" == "4. Quit" ] && (
	echo 'Quitting...'
	exit 0
)

selection=$(printf "%s\n" "$choice" | awk '{ print $1 }')

if [[ "$selection" == "1." ]]; then
	echo "STREAMING..."
	$CMD
elif [[ "$selection" == "2." ]]; then
	dl_dir=$(rofi -dmenu -config "$CFG_DIR/$CFG_FILE" \
		-l 1 -p "Enter downlaod dir:")
	# if dl_dir is none set to current directory
	[ "$dl_dir" == "" ] && dl_dir="$DEFAULT"
	$CMD -d "$dl_dir"
elif [[ "$selection" == "3." ]]; then
	$CMD -H
fi
